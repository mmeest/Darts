<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Noolemäng</title>
    <style>
      body{
        background-color: rgb(105, 201, 178);
        font-family: Arial, Helvetica, sans-serif;
      }
      #fix{
        text-align: center;
        color:rgb(24, 66, 57);
        font-weight: bold;
        width: 80%;
        left: 10%;
        position: fixed;
        z-index: 100;
        background-color: rgb(138, 179, 63);
        border-radius: 20px;
        border-style: solid;
        border-color: rgb(44, 42, 42);
        border-width: 4px;
      }
        .slider {
          -webkit-appearance: none;
          width: 80%;
          height: 25px;
          background: rgb(232, 241, 219);
          outline: none;
          opacity: 0.8;
          -webkit-transition: .2s;
          transition: opacity .2s;
        }
        .slider::-webkit-slider-thumb {
          -webkit-appearance: none;
          appearance: none;
          width: 25px;
          height: 25px;
          background: #f04b7d;
          cursor: pointer;
        }
        .slider:hover {
          opacity: 1;
        }
        td{
          text-align: center;
          border-radius: 12px;
          margin: 6px;
         /*  font-size: x-large; */
          font-size: 6vh;
          padding: 5px;
          background-color: rgb(211, 250, 245);
        }
        table{          
          border-collapse: separate;
          border-spacing: 15px;          
        }
        tr:last-child>td{
          background-color: rgb(234, 250, 192);
        }
        tr:nth-child(1)>td{
          border-style : hidden!important;
          border-color: yellow;
          background-color: rgb(105, 201, 178);
        }
        select{
          border: outset;
          padding: 5px;
          font-size: x-large;
          border-radius: 11px;
          background-color: rgb(234, 250, 192);
        }
        button{
          width: 40px;
          height: 40px;
          border-radius: 50%;
        }
    </style>
</head>
<body>
  <br>
    <div id="fix"><br>
      <input type="range" min="1" max="8" value="3" class="slider" id="myRange" style="width: 100%;">
      <p><img border="0" src="rosen.png" width="20vw" align="right"></p>
      <p><img border="0" src="rosen.png" width="20vw" align="left"></p>
      <p>Mängijate arv: <span id="demo"></span></p>
      <button type="button" onclick="myFunction()">OK</button>
    </div><br><br><br><br><br><br><br><br><br><br>

    <div id="table"></div>

    <script>
        var tableNumber = 100;
        var slider = document.getElementById("myRange");
        var output = document.getElementById("demo");
        output.innerHTML = slider.value;
        
        slider.oninput = function() {
          output.innerHTML = this.value;
        }

        var players = 0;
        var names = ['', 'Ergo', 'Erki', 'Kermo', 'Martin', 'Pille', 'Rauni', 'Rauno', 'Sven', 'Vitali'];
        function myFunction(){
            tableNumber += 1;

            players = slider.value;
            console.log(players);

            var body = document.body,
            tbl  = document.createElement('table');
            tbl.style.width  = '100%';

            /* var tr = tbl.insertRow(); */

            for(var i = 0; i <= 6; i++){
                var tr = tbl.insertRow();

                for(var j = 0; j < players; j++){
                        var td = tr.insertCell();
                        if(i == 0){
                          
                          /* td.appendChild(document.createTextNode('Header')); */
                          //Create and append select list
                          var selectList = document.createElement("select");
                          selectList.id = "mySelect";
                          td.appendChild(selectList);

                          //Create and append the options
                          for (var k = 0; k < names.length; k++) {
                              var option = document.createElement("option");
                              option.value = names[k];
                              option.text = names[k];
                              selectList.appendChild(option);
                          }
                        }else{
                          td.appendChild(document.createTextNode('X'));
                          td.id = tableNumber.toString() + '' + j.toString() + '' + i.toString();

                          td.addEventListener('click', function(evt){
                            myPopup(this.id);
                          });
                        }
                        td.style.border = '1px solid black';
                }
            }
            body.appendChild(tbl);

            linebreak = document.createElement("br");
            body.appendChild(linebreak);

            function myPopup(cellId){

              /* console.log('Cell number is: ' + cellId); */
              let tableNumber = cellId.substring(0, 3);
              /* console.log('Table number is: ' + tableNumber); */
              let columnNumber = cellId.substring(3, 4);
              /* console.log('Column number is: ' + columnNumber); */
              let rowNumber = cellId.substring(4, 5);
              /* console.log('Row number is: ' + rowNumber); */
              let outputNumber = tableNumber + columnNumber + '5';
              /* console.log('Output number is: ' + outputNumber); */

              let row = parseInt(rowNumber);
              /* console.log(row); */

              if(row < 6){
                /* const aNumber = Number(window.prompt("Type a number", "")); */
                /* let currentThrow = Number(window.prompt("Sisesta number:". "")); */
                /* let currentThrow = parseInt(prompt("Sisesta number:", "0"), 10); */
                let currentThrow = prompt("Please enter your name:", "Sisesta number", pattern="[0-9]");
                document.getElementById(cellId).innerHTML = currentThrow;
              }

              let sumValue = 0;

              for(var n = 1; n <= 5; n++){
                let currentValue = document.getElementById(tableNumber + '' + columnNumber + '' + n).innerHTML;
                console.log(currentValue);
                if(!(isNaN(currentValue))){
                  console.log(parseInt(currentValue));
                  console.log(currentValue);
                  sumValue += parseInt(currentValue);
                  console.log(sumValue);
                  console.log(sumValue * 20);
                }
              }
              document.getElementById(tableNumber + '' + columnNumber + '' + 6).innerHTML = sumValue.toString();

              let o = 0;
              for(var x = 0; x < players; x++){
                document.getElementById(tableNumber + '' + x + '' + 6).style.backgroundColor = 'rgb(234, 250, 192)';

                if(parseInt(document.getElementById(tableNumber + '' + x + '' + 6).innerHTML) > o){
                  o = parseInt(document.getElementById(tableNumber + '' + x + '' + 6).innerHTML)
                }
              }

              for(var x = 0; x < players; x++){
                if(parseInt(document.getElementById(tableNumber + '' + x + '' + 6).innerHTML) == o){
                  document.getElementById(tableNumber + '' + x + '' + 6).style.backgroundColor = 'lightgreen';
                }                
              }
            }
        }
        </script>
</body>
</html>
